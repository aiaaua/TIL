# EAGER and LAZY

JPA에서 테이블 간의 연관관계는 객체의 참조를 통해 이뤄지는데  

이 참조하는 객체들의 데이터를 가져오는 시점을 `Fetch Type`이라고 한다.  

`Fetch Type`에는 `EAGER`와 `LAZY` 두 가지가 있다.  

## EAGER

`EAGER` 방식은 하나의 객체를 DB로부터 읽어올 때 참조 객체들의 데이터까지 전부 읽어오는 방식이다.   

따라서 한 번의 쿼리로 모든 정보를 가져오기 때문에 쿼리를 1번만 보내게 된다.   

쿼리를 1번만 보내면 되기 때문에 성능이 좋아보일 수 있지만, 참조 객체가 많은 경우에는 다음과 같은 문제점들이 있을 수 있다.  

- 쿼리문이 길어져 domain을 파악하기 어려움  
- 논리적으로 Layer 분리가 제대로 이뤄지지 않았을 가능성이 높음(유지보수 어려움)

따라서 비지니스 로직 상 참조 객체의 데이터가 반드시 함께 필요한 경우에만 사용하는 것이 좋다.  

실제로 `Fetch Type`으로  `EAGER`를 사용하는 일은 많지 않으며 개발 과정에서 임시로 사용하는 정도이다.    



## LAZY

`LAZY` 방식은 하나의 객체를 DB로부터 읽어올 때 참조 객체들의 데이터는 무시하고 해당 엔티티의 데이터만 가져오는 방식이다.   

따라서 퀴리를 통해 해당 엔티티의 데이터만 가져온 상태에서 참조 객체의 데이터가 필요할 경우 또 다시 쿼리를 보내게 된다.   

참조 객체의 데이터가 조회되지 않은 시점에서는 프록시를 이용하여 객체의 데이터를 null로 둔다.  

비지니스 로직 상 엔티티의 데이터가 주로 필요하고 참조 객체의 데이터가 드물게 필요할 경우에 사용하는 것이 좋다.  

하지만 꼭 그렇지 않더라도, 시간이 지나면서 설계가 추가되거나 변화하는 것을 고려하여 `LAZY`를 사용하여 성능 이슈가 발생할 가능성을 낮춰주는 것이 좋다.  



## Reference

- https://velog.io/@bread_dd/JPA%EB%8A%94-%EC%99%9C-%EC%A7%80%EC%97%B0-%EB%A1%9C%EB%94%A9%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0%EA%B9%8C

- https://velog.io/@jin0849/JPA-%ED%94%84%EB%A1%9D%EC%8B%9CProxy
- https://velog.io/@jin0849/JPA-%EC%A6%89%EC%8B%9C%EB%A1%9C%EB%94%A9EAGER%EA%B3%BC-%EC%A7%80%EC%97%B0%EB%A1%9C%EB%94%A9LAZY
