# 관계형 데이터베이스 설계 및 구축

 관계형 데이터베이스를 설계할 때는 주로 2가지 방법이 사용된다.  

- E-R 모델과 릴레이션 변환 규칙을 이용한 설계
- 정규화를 이용한 설계

이 중에서 E-R 모델과 릴레이션 변환 규칙을 이용한 설계를 알아보자.  

단계는 다음과 같이 4단계로 구성된다.  

1. 데이터 요구사항 분석 → 요구사항 명세서
2. 개념적 설계 → ERD
3. 논리적 설계 → 릴레이션 스키마의 테이블 명세서
4. 물리적 설계 → DB 스키마 생성 SQL



## 1. 요구사항 분석

데이터 베이스에 대한 사용자의 요구사항을 분석하여 요구사항 명세서를 작성한다.  



## 2. 개념적 설계

개념 스키마를 설계하고 그 결과물인 ERD를 만들어보자.  

ERD를 만들기 위해서 개체, 속성, 개체 간의 관계가 필요한데, 이는 이전에 작성한 요구사항 분석에서 추출할 수 있다.  



### 개체 및 속성 추출

개체와 속성은 요구사항에서의 명사들 중에 선별하여 추출할 수 있다.  

그렇다면 그 중에서 개체와 속성은 또 어떻게 구분할 수 있을까?  

개체는 현실에서 사물이나 사람이 생각하는 개념이고, 속성은 개체를 나타내는 정보들이다.  

따라서 속성이 모여 하나의 정보단위를 이루는 것이 개체라고 할 수 있다.  

#### 예시

다음과 같은 문장에서 개체와 속성을 구분해보자.  

```
한빛 항공사에 회원으로 가입하려면 회원아이디, 비밀번호, 성명, 신용카드 정보를 입력해야한다.
```

명사를 선별하면 다음과 같은 것들을 추출할 수 있다.

```
회원, 회원아이디, 비밀번호, 성명, 신용카드
```

이 중에서 `회원아이디`, `비밀번호`, `성명`, `신용카드`는 모두 어떤 `회원`을 나타내는 정보이며 따라서 다음과 같이 개체와 속성을 나눌 수 있다. 

- 개체: `회원`
- 속성: `회원아이디`, `비밀번호`, `성명`, `신용카드`



### 개체 간 관계 추출

개체 간의 관계는 요구사항 중에서 개체 간의 관계를 나타내는 동사 중에 선별하여 추출한다.  

관계의 형태는 1:1, 1:N, N:M로 분류할 수 있으며 제약조건에 따라 필수적 참여와 선택적 참여를 나눌 수 있다.  

#### 관계의 형태

- 1:1 관계(일대일 관계): 개체집합 A의 각 원소가 개체집합 B의 원소 1개와 대응  
- 1:N 관계(일대다 관계): 개체집합 A의 각 원소는 개체집합 B의 원소 여러 개와 대응할 수 있고, 개체집합 B의 각 원소는 개체집합 A의 원소 1개와 대응  
- N:M 관계(다대다 관계): 개체집합 A의 각 원소는 개체집합 B의 원소 여러 개와 대응할 수 있고, 개체집합 B의 각 원소는 개체집합 A의 원소 여러 개와 대응할 수 있음  

#### 관계의 제약조건

- 필수적 참여(total participation)
  - 개체집합 A와 개체집합 B에 대해 개체집합 B의 모든 개체가 [A:B] 관계에 참여
  - ERD에서 이중선으로 표현
- 선택적 참여(partial participation)
  - 개체집합 A와 개체집합 B에 대해 개체집합 B의 일부 개체만 [A:B] 관계에 참여
  - ERD에서 단선으로 표현

#### 관계의 종속성

- 약한 개체(weak entity)
  - 다른 개체의 존재 여부에 의존적인 개체
  - 자신을 식별해주는 강한 개체 타입이 없으면 식별할 수 없음
  - 키를 형성하기에 충분한 속성을 갖지 못함
  - 이중 직사각형으로 표현
- 강한 개체(strong entity)
  - 약한 개체의 존재 여부를 결정하는 개체
  - 다른 개체의 존재여부와 관계없이 독립적으로 존재하여 식별 가능
  - 약한 개체에 키 속성을 제공하는 강한 개체를 식별 개체라 함

### ERD 생성

개체와 속성, 그리고 개체 간 관계를 IE 표기법을 사용해 ERD를 작성할 수 있다.  

IE 표기법은 다음과 같다.  

![image 12](https://blog.advenoh.pe.kr/static/048a59addd49377a99973fcf55cf51c7/32056/image_12.png)



## 3. 논리적 설계

ERD에서 릴레이션 스키마를 만들 때 다음과 같이 5가지 릴레이션 변환 규칙을 따른다.  

1. 모든 개체는 릴레이션으로 변환한다.
2. N:M 관계는 릴레이션으로 변환한다.
3. 1:N 관계는 외래키로 표현한다.
4. 1:1 관계는 외래키로 표현한다.
5. 다중 값 속성은 독립 릴레이션으로 변환한다.

각 릴레이션 변환 규칙에 대해 자세히 알아보자.



### 규칙1

> 모든 개체는 릴레이션으로 변환한다.

개체는 하나의 테이블이 되며, 속성은 테이블의 속성이 된다.

### 규칙2

> N:M 관계는 릴레이션으로 변환한다.

N:M 관계의 이름은  릴레이션의 이름이 되며, 관계의 속성도 릴레이션의 속성으로 변환하면 된다.

여기서 기본 키를 무엇으로 할지에 따라 속성의 구성이 달라진다. 

### 규칙3

> 1:N 관계는 외래키로 표현한다.

일반적으로 1:N 관계에서 1측 개체의 기본키를 N측 릴레이션에 포함시키고 외래키로 지정한다.

단, 1:N 관계에서 약한 개체가 참여하는 경우에는 앞서 말한 바와 동일하게 외래키를 지정하며  

추가된 외래키를 포함하여 기본 키를 지정해야 한다.  

### 규칙4

> 1:1 관계는 외래키로 표현한다.

1:1 관계는 외래키를 서로 주고받으면 된다.  

단, 관계의 제약조건이 필수인지 아닌지에 따라 1:1 관계에 필수적으로 참여하는 개체의 릴레이션만 외래키를 받거나 모든 개체가 1:1 관계에 필수적으로 참여하면 릴레이션 하나로 합치는 등 규칙을 변경하여 적용할 수 있다.  

### 규칙5

> 다중 값 속성은 독립 릴레이션으로 변환한다.

릴레이션에서는 다중 값 속성을 가질 수 없으므로 다중 값 속성을 별도의 릴레이션을 생성해야 한다.  

별도의 릴레이션의 기본 키는 기존 개체의 기본 키를 가져와 다중 값 속성과 함께 기본 키를 구성해야 한다.



## 4. 물리적 설계

관계형 데이터베이스 프로그램을 이용하여 내부 스키마 생성



## Reference

- https://blog.advenoh.pe.kr/database/%EA%B4%80%EA%B3%84%ED%98%95-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%84%A4%EA%B3%84-%EB%B0%8F-%EA%B5%AC%EC%B6%95/
- https://d9249.tistory.com/18
